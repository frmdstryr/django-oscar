{% load i18n %}
{% load wagtailadmin_tags  %}

{{ self.formset.management_form }}

{% if self.formset.non_form_errors %}
    <li class="error-message">
        {% for error in self.formset.non_form_errors %}
            <span>{{ error|escape }}</span>
        {% endfor %}
    </li>
{% endif %}

<table class="listing" id="id_{{ self.formset.prefix }}-FORMS">
    <thead>
        <tr>
            <th></th>
            {% with self.children|first as child %}
                {% for field in child.children %}
                    <th>{{ field.heading }}</th>
                {% endfor %}
            {% endwith %}
            <th></th>
        </tr>
    </thead>
    <tbody>
        {% for child in self.children %}
            <tr class="line-item {% cycle 'odd' 'even' %}" data-inline-panel-child id="inline_child_{{ child.form.prefix }}">
                <td><input type="checkbox" name="line" value="{{ child.instance.id }}" /></td>
                {% for field in child.children %}
                    <td>{{field.render_as_object}}</td>
                {% endfor %}
                <td>
                    <ul class="controls">
                        {% if can_order %}
                            <li><button type="button" class="button icon text-replace white icon-order-up inline-child-move-up" id="{{ child.form.prefix }}-move-up" title="{% trans 'Move up' %}">{% trans "Move up" %}</button></li>
                            <li><button type="button" class="button icon text-replace white icon-order-down inline-child-move-down" id="{{ child.form.prefix }}-move-down" title="{% trans 'Move down' %}">{% trans "Move down" %}</button></li>
                        {% endif %}
                        <li><button type="button" class="button icon text-replace white icon-bin hover-no" id="{{ child.form.DELETE.id_for_label }}-button" title="{% trans 'Delete' %}">{% trans "Delete" %}</button></li>
                    </ul>
                </td>
            </tr>
        {% endfor %}
    </tbody>
</table>


<script type="text/django-form-template" id="id_{{ self.formset.prefix }}-EMPTY_FORM_TEMPLATE">
{% escapescript %}
{% include "wagtailadmin/edit_handlers/inline_panel_child.html" with child=self.empty_child %}
{% endescapescript %}
</script>

<p class="add">
    <a class="button bicolor icon icon-plus" id="id_{{ self.formset.prefix }}-ADD">
        {% blocktrans with label=self.label|lower %}Add {{ label }}{% endblocktrans %}
    </a>
</p>
